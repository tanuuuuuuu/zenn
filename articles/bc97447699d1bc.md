---
title: "dbt Semantic LayerとSteepの連携における勘どころ"
emoji: "🐥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics:
  - "dbt"
  - "Semantic layer"
  - "Steep"
published: true
published_at: "2025-12-05 00:00"
---

[dbt Advent Calendar 2025](https://qiita.com/advent-calendar/2025/dbt) の 5 日目の記事です。

:::message
**この記事で学べること**

- dbt Semantic Layer と Steep の基本概念
- dbt Semantic Layer と Steep との連携時のポイント
- dbt Semantic Layer で制限されている Steep の機能

:::

## dbt Semantic Layer とは

## Steep とは

## 基本設定

### 接続方法

Steep の公式ドキュメントに詳しい手順が記載されているため、そちらを参照してください。

**参考**: [Steep - dbt Semantic Layer 接続ガイド](URL)

### データ更新の仕組み

#### クエリ結果の更新（キャッシュ）

接続後、Steep で実行したクエリ結果は Steep 側でキャッシュされます。
キャッシュの有効期限はワークスペース設定で指定でき、以下から選択可能です:

- 1 時間
- 2 時間
- 4 時間
- 8 時間

設定した期限を過ぎると、次回クエリ実行時に自動的に dbt Semantic Layer から
最新データが取得されます。

#### メタデータの更新（セマンティックモデル・メトリクス定義）

**初回接続時の動作**

初回接続時、dbt 側で定義されている全てのセマンティックモデルとメトリクスが
Steep に同期されます。

**定義変更後の同期**

dbt 側でセマンティックモデルやメトリクスの定義を変更した場合、
**必ず Steep 側で再同期が必要**です。同期方法は 2 種類あります:

##### 1. API Sync（自動同期）

API エンドポイントを使用してメタデータを更新します。

**dbt Webhooks との連携例**:
dbt の Webhooks 機能を設定すると、本番ジョブの成功時に自動的に
API Sync を実行できます。これにより、dbt のデプロイと同時に
Steep 側の定義も最新化されます。

```bash
# API Sync エンドポイント例
curl -X POST "https://api.steep.app/v1/sync" \
  -H "Authorization: Bearer YOUR_API_KEY"
```

##### 2. Manual Sync（手動同期）

Steep の UI 上から手動で同期ボタンをクリックして更新します。
開発環境での動作確認や、小規模な変更時に便利です。

**推奨**: 本番環境では API Sync + dbt Webhooks による自動化を推奨します。

## プロパティの理解

### プロパティ対応表

### Steep 独自のプロパティ

### 非加法性メトリクス

## 制限事項

## まとめ
